(function(a){a.fn.extend({multi_line_input:function(b,c){var d=a.extend({unique_values:!1},c),b=b,e=this,f=c.limit,g=c.sortable,h=1,j=a(this).find(".multi_input_line").first(),k="empty",l={locale:c.locale,stepping:5,useCurrent:!1,calendarWeeks:!0,toolbarPlacement:"top",showClear:!0,keepInvalid:!0,sideBySide:!0,format:"DD.MM.YYYY"};(function(b){b.hide(),b.removeClass("multi_input_line"),b.find("textarea[name^='"+e.attr("id")+"'], input[name^='"+e.attr("id")+"'], select[name^='"+e.attr("id")+"']").each(function(){var b=a(this).attr("name"),c=e.attr("id"),d=new RegExp("^"+c+"[[0-9]+](.*)$","g"),f=d.exec(b);b=k+"["+h+"]"+f[1],a(this).attr("name",b)})})(j);var m=function(b,c){var c=c||!1,d=b;a(b).find(".add_button").on("click",function(){var b=a(".multi_input_line").length;if(0==f||b<f){var c=j.clone();c.show(),a(c).addClass("multi_input_line"),m(c),a(c).insertAfter(a(this).parent().parent());let b=a(c).find("input.chosen");b.parent().find("div.select2-container").remove();let f=b.attr("id").replace(/\[/g,"\\[").replace(/]/g,"\\]");return SrMultipleSelect.init(f),a(e).change(),a(document).trigger("multi_line_add_button",[d,c]),!1}}),a(b).find(".remove_button").on("click",function(){return 2<a(b).parent().children().length?d.remove():(d.find("input").val(""),d.find("span.select2-chosen").text("")),a(e).change(),a(document).trigger("multi_line_remove_button",d),!1}),g&&(a(b).find(".up_button").on("click",function(){a(b).insertBefore(a(b).prev())}),a(b).find(".down_button").on("click",function(){a(b).insertAfter(a(b).next())})),c||d.find("textarea[name^='"+k+"'], input[name^='"+k+"'], select[name^='"+k+"']").each(function(){var b=a(this).attr("name"),c=e.attr("id");a(this).val("");var d=new RegExp("^"+k+"[[0-9]+](.*)$","g"),f=d.exec(b);for(b=c+"["+h+"]"+f[1],i=1;a("[name='"+b+"']").length;)b=c+"["+(h+i)+"]"+f[1],console.log("element exists: "+(h+i)),i++;a(this).attr("name",b),a(this).attr("id",b)}),h++};return a(e).on("change",function(){a(e).find(".multi_input_line .remove_button")}),a(this).find(".multi_input_line").each(function(){m(a(this),!0)}),a(e).change(),e}})})(jQuery);